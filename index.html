<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xiaomi S400</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@400;700&display=swap');
        body { font-family: 'Chakra Petch', sans-serif; background-color: #050505; }
    </style>
</head>
<body class="text-white h-screen flex flex-col items-center justify-center overflow-hidden selection:bg-green-500 selection:text-black">

    <!-- Ambient Background -->
    <div class="absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-green-900/20 via-black to-black z-0"></div>

    <!-- Main Card -->
    <div class="relative z-10 w-full max-w-md p-8">
        
        <!-- Status Indicator -->
        <div class="flex items-center justify-center gap-3 mb-12">
            <div id="status-light" class="w-3 h-3 rounded-full bg-red-600 shadow-[0_0_10px_red] transition-all duration-500"></div>
            <div id="status-text" class="text-sm tracking-[0.2em] text-gray-500 uppercase font-bold transition-colors duration-300">DISCONNECTED</div>
        </div>

        <!-- Weight Display -->
        <div class="text-center relative">
            <div class="absolute -inset-4 bg-green-500/5 blur-3xl rounded-full"></div>
            <h1 class="text-[8rem] font-bold leading-none tracking-tighter text-transparent bg-clip-text bg-gradient-to-b from-white to-gray-400 drop-shadow-2xl">
                <span id="weight-val">0.00</span>
            </h1>
            <div class="text-2xl text-green-500 font-bold tracking-widest mt-2 uppercase">Kilograms</div>
        </div>

        <!-- Meta Data -->
        <div class="mt-16 border-t border-white/10 pt-6 flex justify-between items-end text-xs text-gray-600 font-mono">
            <div>
                <div class="mb-1 uppercase tracking-widest">Last Update</div>
                <div id="last-update" class="text-gray-400 text-sm">--:--:--</div>
            </div>
            <div class="text-right">
                <div class="mb-1 uppercase tracking-widest">Device ID</div>
                <div class="text-gray-400 text-sm">C3:E8</div>
            </div>
        </div>

    </div>

    <script>
        const weightEl = document.getElementById('weight-val');
        const statusText = document.getElementById('status-text');
        const statusLight = document.getElementById('status-light');
        const timeEl = document.getElementById('last-update');

        async function updateDashboard() {
            try {
                const response = await fetch('/data');
                const data = await response.json();

                // Update Weight
                weightEl.innerText = data.weight.toFixed(2);
                timeEl.innerText = data.last_update;
                statusText.innerText = data.status.toUpperCase();

                // Update Status Styles
                if (data.status.toLowerCase().includes('connected')) {
                    statusLight.className = "w-3 h-3 rounded-full bg-green-500 shadow-[0_0_20px_#22c55e] animate-pulse";
                    statusText.className = "text-sm tracking-[0.2em] text-green-500 uppercase font-bold";
                } else if (data.status.toLowerCase().includes('scanning')) {
                    statusLight.className = "w-3 h-3 rounded-full bg-yellow-500 shadow-[0_0_10px_orange]";
                    statusText.className = "text-sm tracking-[0.2em] text-yellow-500 uppercase font-bold";
                } else {
                    statusLight.className = "w-3 h-3 rounded-full bg-red-600 shadow-[0_0_10px_red]";
                    statusText.className = "text-sm tracking-[0.2em] text-gray-500 uppercase font-bold";
                }

            } catch (error) {
                console.error("Fetch error:", error);
                statusText.innerText = "OFFLINE";
                statusLight.className = "w-3 h-3 rounded-full bg-gray-700";
            }
        }

        // Poll every 500ms for instant updates
        setInterval(updateDashboard, 500);
    </script>
</body>
</html>
